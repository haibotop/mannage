/**
 * GooFlow-Vue - Web端流程设计器
 * @author foolegg126 (sdlddr)
 * @version v1.2.0
 * @license Commercially licensed to 永凯软件技术(上海)有限公司-913101157867305734(imclouds)
 **/
import Class from"../common/Class";let printThis=function(e,t){let o={pageTitle:"",base:!1};Object.assign(o,t);let n="printThis-"+(new Date).getTime(),i=document.createElement("iframe");i.name="printIframe",i.id=n,document.body.appendChild(i),window.location.hostname!==document.domain&&navigator.userAgent.match(/msie/i)&&(i.className="MSIE",i.src='javascript:document.write("<head><script>document.domain="'+document.domain+'";<\/script></head><body></body>")');let l=document.getElementById(n);Class.css(l,{position:"absolute",width:"0px",height:"0px",left:"-600px",top:"-600px"}),setTimeout(function(){!function(e,t){let o=(e=e.contentWindow||e.contentDocument||e).document||e.contentDocument||e;o.open(),o.write(t),o.close()}(l,"<!DOCTYPE html>");let t=l.document||l.contentDocument||l,n=t.head,i=t.body,r=document.querySelector("base"),d="";Class.css(i,{height:"auto",margin:"0",padding:"0",background:"#fff"}),d=!0===o.base&&null!=r?r.getAttribute("href"):"string"==typeof o.base?o.base:document.location.protocol+"//"+document.location.host;let a=t.createElement("base");a.setAttribute("href",d),n.appendChild(a);let c=document.querySelectorAll("link");for(let e=0;e<c.length;++e){let t=c[e].getAttribute("href");if(t&&null!=t&&""!==t){let t=c[e].getAttribute("media")||"all",o=c[e].cloneNode(!0);o.setAttribute("media",t),n.appendChild(o)}}let s=document.querySelectorAll("style");for(let e=0;e<s.length;++e){let t=s[e].cloneNode(!0);n.appendChild(t)}if(o.pageTitle){let e=t.createElement("title");e.innerHTML=o.pageTitle,n.appendChild(e)}let p=e.cloneNode(!0);i.appendChild(p),setTimeout(function(){if(Class.hasClass(l,"MSIE")){window.frames.printIframe.focus();let e=document.createElement("script");e.type="text/javascript",e.innerHTML="window.print();",n.appendChild(e)}else document.queryCommandSupported("print")?l.contentWindow.document.execCommand("print",!1,null):(l.contentWindow.focus(),l.contentWindow.print());setTimeout(function(){l.parentNode.removeChild(l)},1e3)},333)},333)};export default{flag:"print",methods:{print(e){let t=this._suitSize();e||(e=1),t.width+=100,t.height+=100;let o=this.$refs.$workArea.cloneNode(!0),n=["",".GooFlow_work_paper",".GooFlow_work_group","svg"];for(let e of n){let n=""===e?o:o.querySelector(e);n&&null!=n&&(n.style.width=t.width+"px",n.style.height=t.height+"px")}const i=document.createElement("div");i.className="GooFlow GooFlow_work",i.style.width=t.width+"px",i.style.height=t.height+"px",i.style.overflow="hidden",i.append(o),this.GooFlow.color.font&&(i.style.color=this.GooFlow.color.font),i.style.transform="scale("+e+")",i.style.transformOrigin="top left",printThis(i,{base:document.URL,pageTitle:this.prop.$title})}}};